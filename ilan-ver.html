<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ä°lan Ver</title>
<style>
body {
  font-family: Arial;
  background:#f5f5f5;
  padding:30px;
}
.box {
  background:#fff;
  padding:20px;
  max-width:400px;
  margin:auto;
  border-radius:8px;
}
input, button {
  width:100%;
  padding:10px;
  margin-top:10px;
}
button {
  background:#000;
  color:#fff;
  border:none;
}
</style>
</head>
<body>

<div class="box">
  <h2>Ä°lan Ver</h2>

  <input id="marka" placeholder="Marka">
  <input id="model" placeholder="Model">
  <input id="yil" type="number" placeholder="YÄ±l">
  <input id="km" type="number" placeholder="KM">
  <input id="fiyat" type="number" placeholder="Fiyat">

  <button onclick="kaydet()">Ä°lanÄ± GÃ¶nder</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, addDoc, collection } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDp3wjVF9w3MTFt0B1o4Jcdc_H9nvlqSY8",
  authDomain: "ilkeloto.firebaseapp.com",
  projectId: "ilkeloto"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

// ðŸ” GiriÅŸ kontrolÃ¼
onAuthStateChanged(auth, user => {
  if (!user) {
    window.location.href = "auth.html";
  } else {
    currentUser = user;
  }
});

window.kaydet = async () => {
  await addDoc(collection(db, "ilanlar"), {
    Marka: marka.value,
    Model: model.value,
    Yil: Number(yil.value),
    Km: Number(km.value),
    Fiyat: Number(fiyat.value),
    Durum: "beklemede",
    userId: currentUser.uid
  });

  alert("Ä°lan gÃ¶nderildi, admin onayÄ± bekleniyor");
  window.location.href = "index.html";
};
</script>

</body>
</html>
