<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ä°lkel Oto | OnaylÄ± Ä°lanlar</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f2f2f2;
}
header{
  background:#111;
  color:#fff;
  padding:25px;
  text-align:center;
}
main{
  display:flex;
  max-width:1300px;
  margin:20px auto;
  gap:20px;
  padding:0 15px;
}
aside{
  width:230px;
  background:#fff;
  padding:15px;
  border-radius:6px;
  height:fit-content;
}
aside h3{margin-top:0}
aside ul{list-style:none;padding:0;margin:0}
aside li{
  padding:8px;
  cursor:pointer;
  border-radius:4px;
}
aside li:hover,
aside li.active{
  background:#111;
  color:#fff;
}

.content{flex:1}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:20px;
}
.card{
  background:#fff;
  border-radius:6px;
  padding:15px;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
  cursor:pointer;
  transition:.2s;
}
.card:hover{
  transform:translateY(-2px);
}
.card h3{margin:0 0 10px}
.price{
  color:green;
  font-weight:bold;
  font-size:18px;
}

footer{
  background:#111;
  color:#fff;
  text-align:center;
  padding:15px;
  margin-top:40px;
}
</style>
</head>

<body>

<header>
  <h1>Ä°LKEL OTO</h1>
  <p>OnaylÄ± Sahibinden Ä°lanlar</p>
</header>

<main>

<!-- SOL FÄ°LTRE -->
<aside>
  <h3>Markalar</h3>
  <ul id="markalar">
    <li class="active" data-marka="">TÃ¼mÃ¼</li>
  </ul>
</aside>

<!-- Ä°LANLAR -->
<div class="content">
  <div id="ilanlar" class="grid">YÃ¼kleniyor...</div>
</div>

</main>

<footer>
  Â© 2026 Ä°lkel Oto
</footer>

<!-- ðŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  query,
  where,
  getDocs
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ðŸ”´ KENDÄ° FIREBASE BÄ°LGÄ°LERÄ°N */
const firebaseConfig = {
  apiKey: "API_KEYÄ°N",
  authDomain: "ilkeloto.firebaseapp.com",
  projectId: "ilkeloto"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const ilanAlan = document.getElementById("ilanlar");
const markaAlan = document.getElementById("markalar");

let tumIlanlar = [];

/* Ä°LANLARI Ã‡EK */
async function yukle(){
  const q = query(
    collection(db,"ilanlar"),
    where("durum","==","onayli")
  );

  const snap = await getDocs(q);

  tumIlanlar = [];
  const markaSet = new Set();

  snap.forEach(d=>{
    const data = d.data();
    tumIlanlar.push({
      id: d.id,
      ...data
    });
    markaSet.add(data.marka);
  });

  // MARKALARI SOLA BAS
  markaSet.forEach(m=>{
    const li = document.createElement("li");
    li.textContent = m;
    li.dataset.marka = m;
    markaAlan.appendChild(li);
  });

  filtre("");
}

/* FÄ°LTRELEME */
function filtre(marka){
  document.querySelectorAll("aside li").forEach(li=>li.classList.remove("active"));
  document.querySelector(`aside li[data-marka="${marka}"]`)?.classList.add("active");

  if(!marka){
    goster(tumIlanlar);
  }else{
    goster(tumIlanlar.filter(i=>i.marka===marka));
  }
}

/* Ä°LANLARI GÃ–STER */
function goster(liste){
  ilanAlan.innerHTML = "";

  if(liste.length===0){
    ilanAlan.innerHTML = "Ä°lan bulunamadÄ±";
    return;
  }

  liste.forEach(i=>{
    const div = document.createElement("div");
    div.className = "card";
    div.onclick = ()=> {
      window.location.href = "ilan-detay.html?id=" + i.id;
    };

    div.innerHTML = `
      <h3>${i.marka} ${i.model}</h3>
      <p>YÄ±l: ${i.yil}</p>
      <p>KM: ${i.km}</p>
      <p class="price">${i.fiyat} â‚º</p>
      <p><b>Tel:</b> ${i.telefon}</p>
    `;

    ilanAlan.appendChild(div);
  });
}

/* TIKLAMA */
markaAlan.addEventListener("click",e=>{
  if(e.target.tagName==="LI"){
    filtre(e.target.dataset.marka);
  }
});

yukle();
</script>

</body>
</html>
