<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ä°LKEL OTO</title>

<style>

body{margin:0;font-family:Arial;background:#f2f2f2}

header{
background:#ffde00;
padding:12px;
display:flex;
justify-content:space-between;
align-items:center
}

header button{
padding:8px 12px;
border:none;
cursor:pointer;
font-weight:bold
}

.container{display:flex;padding:10px}

.filter{
width:260px;
background:#fff;
padding:10px;
border-radius:6px
}

.filter input,.filter select{
width:100%;
padding:8px;
margin-bottom:8px
}

.content{flex:1;margin-left:10px}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
gap:10px
}

.card{
background:#fff;
padding:10px;
border:1px solid #ddd;
border-radius:6px;
position:relative;
cursor:pointer
}

.card img{
width:100%;
height:160px;
object-fit:cover
}

.price{
color:green;
font-weight:bold;
font-size:18px
}

.fav{
position:absolute;
top:8px;
right:8px;
font-size:22px;
cursor:pointer;
color:#999
}

.fav.active{color:red}

</style>
</head>

<body>

<header>
<h2>Ä°LKEL OTO</h2>

<div>
<button onclick="location.reload()">ğŸ”„ Yeni Ä°lanlarÄ± YÃ¼kle</button>
<a href="favoriler.html">â¤ï¸ Favoriler</a>
</div>

</header>

<div class="container">

<div class="filter">

<input id="keyword" placeholder="Ara">

<select id="cityFilter">
<option value="">Åehir</option>
<option>Ä°stanbul</option>
<option>Ankara</option>
<option>Ä°zmir</option>
<option>Bursa</option>
<option>Antalya</option>
<option>Adana</option>
<option>Konya</option>
<option>Gaziantep</option>
<option>Kocaeli</option>
<option>Mersin</option>
</select>

<button onclick="filter()">Ara</button>

</div>

<div class="content">
<div id="list" class="grid"></div>
</div>

</div>

<script>

// VERÄ° OKU
function getCars(){
return JSON.parse(localStorage.getItem("cars")) || [];
}

let favs = JSON.parse(localStorage.getItem("favs")) || [];

const list=document.getElementById("list");

// FAVORI
function isFav(id){
return favs.includes(id);
}

function toggleFav(id,e){

e.stopPropagation();

if(isFav(id)){
favs=favs.filter(x=>x!=id);
}else{
favs.push(id);
}

localStorage.setItem("favs",JSON.stringify(favs));
render(getCars());
}

// LÄ°STELE
function render(arr){

list.innerHTML="";

arr.forEach(i=>{

let favClass=isFav(i.id)?"fav active":"fav";

list.innerHTML+=`

<div class="card" onclick="goDetail(${i.id})">

<div class="${favClass}" onclick="toggleFav(${i.id},event)">â¤</div>

<img src="${i.images[0]}">

<b>${i.brand} ${i.model}</b><br>
${i.city}<br>

<div class="price">${i.price} â‚º</div>

</div>

`;

});

}

// DETAY
function goDetail(id){
location.href="ilan.html?id="+id;
}

// FÄ°LTRE
function filter(){

let key=keyword.value.toLowerCase();
let city=cityFilter.value;

let data=getCars();

let result=data.filter(i=>
(i.brand.toLowerCase().includes(key)||
 i.model.toLowerCase().includes(key)) &&
(!city || i.city==city)
);

render(result);
}

// Ä°LK YÃœKLEME
render(getCars());

</script>

</body>
</html>
