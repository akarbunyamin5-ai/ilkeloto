<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>İLKEL OTO</title>

<style>

body{
margin:0;
font-family:Arial;
background:#f2f2f2;
}

header{
background:black;
color:white;
padding:15px;
font-size:22px;
font-weight:bold;
}

.container{
display:flex;
padding:15px;
gap:15px;
}

.sidebar{
width:260px;
background:white;
padding:15px;
border-radius:8px;
}

.sidebar input,.sidebar select{
width:100%;
padding:8px;
margin-bottom:10px;
}

.content{
flex:1;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
gap:15px;
}

.card{
background:white;
border-radius:8px;
overflow:hidden;
box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

.card img{
width:100%;
height:160px;
object-fit:cover;
}

.card-body{
padding:10px;
}

.price{
color:green;
font-weight:bold;
font-size:18px;
}

</style>
</head>

<body>

<header>
İLKEL OTO — Sahibinden Araç Pazarı
</header>

<div class="container">

<div class="sidebar">

<select id="brandFilter">
<option value="">Marka</option>
</select>

<input id="minPrice" type="number" placeholder="Min Fiyat">
<input id="maxPrice" type="number" placeholder="Max Fiyat">

<button onclick="applyFilter()">Filtrele</button>

</div>

<div class="content">
<div class="grid" id="listings"></div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyDp3wjVf9w3MTFt0B1o4Jcdc_H9nvlqSY8",
authDomain: "ilkeloto.firebaseapp.com",
projectId: "ilkeloto",
storageBucket: "ilkeloto.appspot.com",
messagingSenderId: "503658235063",
appId: "1:503658235063:web:e271d2bc989be290b97932"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let allCars=[];

async function loadCars(){

const snap = await getDocs(collection(db,"cars"));

allCars=[];

snap.forEach(doc=>{
allCars.push(doc.data());
});

render(allCars);
loadBrands();

}

function render(data){

listings.innerHTML="";

data.forEach(car=>{

listings.innerHTML+=`

<div class="card">
<img src="${car.image}">
<div class="card-body">
<b>${car.brand} ${car.model}</b><br>
${car.year} | ${car.km} KM
<div class="price">${car.price} ₺</div>
</div>
</div>

`;

});

}

function loadBrands(){

const brands=[...new Set(allCars.map(c=>c.brand))];

brandFilter.innerHTML="<option value=''>Marka</option>";

brands.forEach(b=>{
brandFilter.innerHTML+=`<option>${b}</option>`;
});

}

window.applyFilter=function(){

let brand=brandFilter.value;
let min=minPrice.value;
let max=maxPrice.value;

let filtered=allCars.filter(c=>{

let ok=true;

if(brand && c.brand!=brand) ok=false;
if(min && c.price<min) ok=false;
if(max && c.price>max) ok=false;

return ok;

});

render(filtered);

}

loadCars();

</script>

</body>
</html>
