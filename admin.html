<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Admin Panel | Ä°lkel Oto</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background:#111;
  color:#fff;
  margin:0;
}
.container {
  max-width:1100px;
  margin:40px auto;
}
h1 {
  text-align:center;
  margin-bottom:30px;
}
.card {
  background:#1e1e1e;
  padding:20px;
  margin-bottom:15px;
  border-radius:6px;
}
.row {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
}
.row div {
  flex:1;
  min-width:200px;
}
button {
  padding:8px 14px;
  border:none;
  cursor:pointer;
  margin-right:5px;
}
.onay {
  background:green;
  color:white;
}
.sil {
  background:red;
  color:white;
}
small {
  color:#aaa;
}
</style>
</head>

<body>
<div class="container">
  <h1>Admin Onay Paneli</h1>
  <div id="ilanlar">YÃ¼kleniyor...</div>
</div>

<!-- ðŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  query,
  where,
  getDocs,
  updateDoc,
  deleteDoc,
  doc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "API_KEYÄ°N",
  authDomain: "ilkeloto.firebaseapp.com",
  projectId: "ilkeloto",
  storageBucket: "ilkeloto.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const alan = document.getElementById("ilanlar");

async function yukle() {
  alan.innerHTML = "";
  const q = query(
    collection(db, "ilanlar"),
    where("durum", "==", "beklemede")
  );

  const snap = await getDocs(q);

  if (snap.empty) {
    alan.innerHTML = "<p>Bekleyen ilan yok.</p>";
    return;
  }

  snap.forEach(d => {
    const i = d.data();
    alan.innerHTML += `
      <div class="card">
        <div class="row">
          <div><b>${i.marka} ${i.model}</b></div>
          <div>YÄ±l: ${i.yil}</div>
          <div>KM: ${i.km}</div>
          <div>Fiyat: ${i.fiyat} â‚º</div>
        </div>
        <p><small>AÃ§Ä±klama:</small><br>${i.aciklama || "-"}</p>
        <p><small>Ekspertiz:</small><br>${i.ekspertiz || "-"}</p>
        <p><small>Telefon:</small> ${i.telefon}</p>

        <button class="onay" onclick="onayla('${d.id}')">ONAYLA</button>
        <button class="sil" onclick="sil('${d.id}')">SÄ°L</button>
      </div>
    `;
  });
}

window.onayla = async function(id) {
  await updateDoc(doc(db,"ilanlar",id), { durum:"onayli" });
  yukle();
};

window.sil = async function(id) {
  if (!confirm("Silmek istiyor musun?")) return;
  await deleteDoc(doc(db,"ilanlar",id));
  yukle();
};

yukle();
</script>
</body>
</html>
